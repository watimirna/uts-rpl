@startuml Stock Opname Use Case Diagram

' Styling
skinparam actorStyle awesome
skinparam packageStyle rectangle
skinparam usecaseBackgroundColor LightBlue
skinparam usecaseBackgroundColor<<critical>> LightCoral

title Use Case Diagram - Modul Stock Opname

' Actors
actor "User" as user

' System boundary
rectangle "Sistem Stock Opname" {

    ' Main Stock Opname Flow
    usecase "Lihat Daftar Produk" as UC1
    usecase "Pilih Produk" as UC2
    usecase "Input Stok Fisik (Counted Stock)" as UC3
    usecase "Tambah Catatan (Opsional)" as UC4
    usecase "Submit Stock Opname" as UC5
    usecase "Hitung Selisih Stok" as UC6 <<critical>>
    usecase "Update Stok Sistem" as UC7 <<critical>>
    usecase "Catat Transaksi" as UC8
}

' User relationships
user --> UC1
user --> UC2
user --> UC3
user --> UC4
user --> UC5

' Flow relationships
UC1 ..> UC2 : <<include>>
UC2 ..> UC3 : <<include>>
UC3 .> UC4 : <<extend>>
UC5 ..> UC6 : <<include>>
UC6 ..> UC7 : <<include>>
UC7 ..> UC8 : <<include>>

note right of UC6
  Selisih dihitung otomatis:
  difference = counted_stock - current_stock

  Hasil:
  - diff = 0: Tidak ada penyesuaian
  - diff > 0: stockIn (kelebihan)
  - diff < 0: stockOut (kekurangan)
end note

note right of UC7
  Penyesuaian langsung dilakukan
  tanpa approval workflow.

  Menggunakan StockService:
  - stockIn() jika diff > 0
  - stockOut() jika diff < 0
end note

note right of UC8
  ProductTransaction dicatat
  dengan type = 'stock_opname'
end note

@enduml
